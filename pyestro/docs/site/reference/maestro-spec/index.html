
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python Configuration Management Orchestrator">
      
      
        <meta name="author" content="Your Name">
      
      
      
        <link rel="prev" href="../../developer-guide/contributing/">
      
      
        <link rel="next" href="../config-schema/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Original Maestro Spec - Pyestro Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#original-maestro-specification" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pyestro Documentation" class="md-header__button md-logo" aria-label="Pyestro Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pyestro Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Original Maestro Spec
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/installation/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user-guide/commands/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developer-guide/architecture/" class="md-tabs__link">
          
  
  
  Developer Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pyestro Documentation" class="md-nav__button md-logo" aria-label="Pyestro Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Pyestro Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/reclass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reclass Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/ansible/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ansible Integration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-guide/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-guide/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-guide/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Original Maestro Spec
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Original Maestro Spec
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-background" class="md-nav__link">
    <span class="md-ellipsis">
      Project Background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Project Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#historical-context" class="md-nav__link">
    <span class="md-ellipsis">
      Historical Context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#philosophy" class="md-nav__link">
    <span class="md-ellipsis">
      Philosophy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#three-layer-design" class="md-nav__link">
    <span class="md-ellipsis">
      Three-Layer Design
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-components" class="md-nav__link">
    <span class="md-ellipsis">
      Core Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-configuration-system" class="md-nav__link">
    <span class="md-ellipsis">
      1. Configuration System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-repository-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Repository Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-reclass-integration" class="md-nav__link">
    <span class="md-ellipsis">
      3. Reclass Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-ansible-integration" class="md-nav__link">
    <span class="md-ellipsis">
      4. Ansible Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Command Interface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#primary-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Primary Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Primary Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization-and-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization and Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-and-class-management" class="md-nav__link">
    <span class="md-ellipsis">
      Node and Class Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-operations" class="md-nav__link">
    <span class="md-ellipsis">
      File Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Search Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status-and-information" class="md-nav__link">
    <span class="md-ellipsis">
      Status and Information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-line-options" class="md-nav__link">
    <span class="md-ellipsis">
      Command-Line Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command-Line Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering-options" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execution-options" class="md-nav__link">
    <span class="md-ellipsis">
      Execution Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-options" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Schema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-configuration-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Core Configuration Variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Configuration Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Project Settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Repository Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-mappings" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Mappings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-from-maestro-to-pyestro" class="md-nav__link">
    <span class="md-ellipsis">
      Migration from Maestro to Pyestro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migration from Maestro to Pyestro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-differences" class="md-nav__link">
    <span class="md-ellipsis">
      Key Differences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migration-path" class="md-nav__link">
    <span class="md-ellipsis">
      Migration Path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compatibility-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Compatibility Considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Implementation Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#awk-parser-original" class="md-nav__link">
    <span class="md-ellipsis">
      AWK Parser (Original)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-implementation-pyestro" class="md-nav__link">
    <span class="md-ellipsis">
      Python Implementation (Pyestro)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-limitations-of-original-maestro" class="md-nav__link">
    <span class="md-ellipsis">
      Known Limitations of Original Maestro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Known Limitations of Original Maestro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#technical-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Limitations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functional-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Functional Limitations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conclusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config-schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration Schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Migration Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-background" class="md-nav__link">
    <span class="md-ellipsis">
      Project Background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Project Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#historical-context" class="md-nav__link">
    <span class="md-ellipsis">
      Historical Context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#philosophy" class="md-nav__link">
    <span class="md-ellipsis">
      Philosophy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#three-layer-design" class="md-nav__link">
    <span class="md-ellipsis">
      Three-Layer Design
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-components" class="md-nav__link">
    <span class="md-ellipsis">
      Core Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-configuration-system" class="md-nav__link">
    <span class="md-ellipsis">
      1. Configuration System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-repository-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Repository Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-reclass-integration" class="md-nav__link">
    <span class="md-ellipsis">
      3. Reclass Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-ansible-integration" class="md-nav__link">
    <span class="md-ellipsis">
      4. Ansible Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Command Interface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#primary-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Primary Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Primary Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization-and-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization and Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-and-class-management" class="md-nav__link">
    <span class="md-ellipsis">
      Node and Class Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-operations" class="md-nav__link">
    <span class="md-ellipsis">
      File Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Search Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status-and-information" class="md-nav__link">
    <span class="md-ellipsis">
      Status and Information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-line-options" class="md-nav__link">
    <span class="md-ellipsis">
      Command-Line Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command-Line Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering-options" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execution-options" class="md-nav__link">
    <span class="md-ellipsis">
      Execution Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-options" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Schema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-configuration-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Core Configuration Variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Configuration Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Project Settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Repository Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-mappings" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Mappings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-from-maestro-to-pyestro" class="md-nav__link">
    <span class="md-ellipsis">
      Migration from Maestro to Pyestro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migration from Maestro to Pyestro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-differences" class="md-nav__link">
    <span class="md-ellipsis">
      Key Differences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migration-path" class="md-nav__link">
    <span class="md-ellipsis">
      Migration Path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compatibility-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Compatibility Considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Implementation Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#awk-parser-original" class="md-nav__link">
    <span class="md-ellipsis">
      AWK Parser (Original)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-implementation-pyestro" class="md-nav__link">
    <span class="md-ellipsis">
      Python Implementation (Pyestro)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-limitations-of-original-maestro" class="md-nav__link">
    <span class="md-ellipsis">
      Known Limitations of Original Maestro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Known Limitations of Original Maestro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#technical-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Limitations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functional-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Functional Limitations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conclusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="original-maestro-specification">Original Maestro Specification</h1>
<p>This document provides a comprehensive specification of the original bash-based Maestro configuration management orchestrator, which serves as the foundation for the modern Python-based Pyestro implementation.</p>
<h2 id="overview">Overview</h2>
<p>Maestro is a bash-based configuration management orchestrator that provides a unified interface for managing heterogeneous infrastructure environments. Originally developed to bridge the gap between metadata stored in reclass and various configuration management tools, primarily Ansible.</p>
<h2 id="project-background">Project Background</h2>
<h3 id="historical-context">Historical Context</h3>
<ul>
<li><strong>Origin</strong>: Started with cfengine automation</li>
<li><strong>Evolution</strong>: Moved through various CM tools (cfengine, ansible, salt, debops)</li>
<li><strong>Challenge</strong>: Different customers using different CM systems</li>
<li><strong>Solution</strong>: Unified orchestrator using reclass as common knowledge base</li>
</ul>
<h3 id="philosophy">Philosophy</h3>
<blockquote>
<p>"The central idea behind maestro is to build a knowledge base (CMDB) that can be used by several configuration management tools. It must be flexible enough to be split up as needed and simple enough such that one can work on several projects without having to think too much."</p>
</blockquote>
<h2 id="architecture">Architecture</h2>
<h3 id="three-layer-design">Three-Layer Design</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>BACKEND0 (meta-data):              BACKEND1 (concrete-data):
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    ,---------.                         ,---------.
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>   |`----------&#39;--.                    |`----------&#39;--.
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>   |  reclass0 |---&#39;--.                |  confix0  |---&#39;--.
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>   |           |s1 |---&#39;               |           |1  |---&#39;&lt;--.
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    `---------&#39;    |.. |                `---------&#39;    |.. |   |
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        `---------&#39;    |                    `---------&#39;    |   |
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>            \---------&#39;                     /   `---------&#39;    |
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>              \| _______________________  |/                   |
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>               ,&#39;                       `.                     |
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>CONNECTOR:    (       m a e s t r o       )                    |
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>               `._______________________,&#39;\                    |
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>                  /     /      |   _        \                  |
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>                 V     V   _   V  |C| ____    \                |
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>             __________   | | ___ |F||Temp|     \              |
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>            (==========&#39;  |d||   ||E||late|       \            |
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>CONFIGURATION    |\ Ansible |  |e|| S ||n||    |        |(plain     |
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>MANAGEMENT:      || \       |  |b|| a ||g|| j2 | _____  | files)   /
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>                ||  |~~~~~ |  |o|| l ||i|| .. || ... | |        /
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>                ||  |~~~~~ |  |p|| t ||n||    || ... | |      /
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>                ||  |~~~~~ |  |s||   ||e||    || ... | |    /
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>                (|  |______| .|_||___||_||____||_____| |  /
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>                 \  |                                /  /
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>                   \| |      |      |  |   |       /  /
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>                      |      |      |  |   |     /  /
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>                      V      V      V  V   V    V /
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    MACHINES:     [ host0 ][ host1 ] ... [ hostN ]
</code></pre></div>
<h2 id="core-components">Core Components</h2>
<h3 id="1-configuration-system">1. Configuration System</h3>
<ul>
<li><strong>Format</strong>: Bash configuration file (<code>.maestro</code>)</li>
<li><strong>Hierarchy</strong>: System → Global → User → Local → Command-line</li>
<li><strong>Location Precedence</strong>:</li>
<li><code>/etc/maestro</code></li>
<li><code>/usr/etc/maestro</code></li>
<li><code>/usr/local/etc/maestro</code></li>
<li><code>~/.maestro</code></li>
<li><code>./maestro</code> or <code>./.maestro</code></li>
<li>Command-line specified config</li>
</ul>
<h3 id="2-repository-management">2. Repository Management</h3>
<ul>
<li><strong>Git Integration</strong>: Clone and manage multiple repositories</li>
<li><strong>Repository Types</strong>:</li>
<li><code>maestro</code> - The orchestrator itself</li>
<li><code>common_inv</code> - Common inventory/metadata</li>
<li><code>common_playbooks</code> - Shared Ansible playbooks</li>
<li><code>packer_templates</code> - Infrastructure templates</li>
<li><code>vagrant_boxes</code> - Development environments</li>
</ul>
<h3 id="3-reclass-integration">3. Reclass Integration</h3>
<ul>
<li><strong>Knowledge Base</strong>: Primary metadata backend</li>
<li><strong>Inventory Management</strong>: Merged inventory in <code>.inventory/</code></li>
<li><strong>Node Processing</strong>: AWK-based parsing of reclass output</li>
<li><strong>Class Organization</strong>: Hierarchical class structure</li>
</ul>
<h3 id="4-ansible-integration">4. Ansible Integration</h3>
<ul>
<li><strong>Module Execution</strong>: Direct ansible module calls</li>
<li><strong>Playbook Management</strong>: Discover and execute playbooks</li>
<li><strong>Galaxy Support</strong>: Role management</li>
<li><strong>Configuration</strong>: Dynamic ansible.cfg generation</li>
</ul>
<h2 id="command-interface">Command Interface</h2>
<h3 id="primary-commands">Primary Commands</h3>
<h4 id="initialization-and-setup">Initialization and Setup</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Initialize environment with all defined repos</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>maestro.sh<span class="w"> </span>init
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Update reclass environment without pulling repos</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>maestro.sh<span class="w"> </span>reinit
</code></pre></div>
<h4 id="node-and-class-management">Node and Class Management</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># List hosts sorted by applications</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>maestro.sh<span class="w"> </span>applications-list<span class="w"> </span><span class="o">[</span>app<span class="o">]</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>maestro.sh<span class="w"> </span>als<span class="w"> </span><span class="o">[</span>app<span class="o">]</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1"># List hosts sorted by class</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>maestro.sh<span class="w"> </span>classes-list<span class="w"> </span><span class="o">[</span>class<span class="o">]</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>maestro.sh<span class="w"> </span>cls<span class="w"> </span><span class="o">[</span>class<span class="o">]</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c1"># List all nodes</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>maestro.sh<span class="w"> </span>nodes-list
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>maestro.sh<span class="w"> </span>nls
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="c1"># Show node details</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>maestro.sh<span class="w"> </span>node-show<span class="w"> </span>nodename
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>maestro.sh<span class="w"> </span>ns<span class="w"> </span>nodename
</code></pre></div>
<h4 id="ansible-operations">Ansible Operations</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Execute ansible module</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>maestro.sh<span class="w"> </span>ansible-module<span class="w"> </span>module<span class="w"> </span><span class="o">[</span>args<span class="o">]</span><span class="w"> </span><span class="o">[</span>vars<span class="o">]</span><span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>maestro.sh<span class="w"> </span>ansible<span class="w"> </span>module<span class="w"> </span><span class="o">[</span>args<span class="o">]</span><span class="w"> </span><span class="o">[</span>vars<span class="o">]</span><span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c1"># Run playbook</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>maestro.sh<span class="w"> </span>ansible-play<span class="w"> </span>playbook<span class="w"> </span><span class="o">[</span>vars<span class="o">]</span><span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>maestro.sh<span class="w"> </span>play<span class="w"> </span>playbook<span class="w"> </span><span class="o">[</span>vars<span class="o">]</span><span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c1"># Loop playbook with items</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>maestro.sh<span class="w"> </span>ansible-play-loop<span class="w"> </span>playbook<span class="w"> </span><span class="nv">itemkey</span><span class="o">=</span>val1:val2<span class="w"> </span><span class="o">[</span>vars<span class="o">]</span><span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>maestro.sh<span class="w"> </span>ploop<span class="w"> </span>playbook<span class="w"> </span><span class="nv">itemkey</span><span class="o">=</span>val1:val2<span class="w"> </span><span class="o">[</span>vars<span class="o">]</span><span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c1"># List available playbooks</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>maestro.sh<span class="w"> </span>ansible-plays-list<span class="w"> </span><span class="o">[</span>play<span class="o">]</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>maestro.sh<span class="w"> </span>pls<span class="w"> </span><span class="o">[</span>play<span class="o">]</span>
</code></pre></div>
<h4 id="file-operations">File Operations</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Merge files from storage to workdir</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>maestro.sh<span class="w"> </span>merge<span class="w"> </span><span class="o">[</span>subdir<span class="o">]</span><span class="w"> </span><span class="o">[</span>rsync-options<span class="o">]</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>maestro.sh<span class="w"> </span>mg<span class="w"> </span><span class="o">[</span>subdir<span class="o">]</span><span class="w"> </span><span class="o">[</span>rsync-options<span class="o">]</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c1"># Unmerge files from workdir back to storage</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>maestro.sh<span class="w"> </span>unmerge<span class="w"> </span><span class="o">[</span>subdir<span class="o">]</span><span class="w"> </span><span class="o">[</span>rsync-options<span class="o">]</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>maestro.sh<span class="w"> </span>umg<span class="w"> </span><span class="o">[</span>subdir<span class="o">]</span><span class="w"> </span><span class="o">[</span>rsync-options<span class="o">]</span>
</code></pre></div>
<h4 id="search-operations">Search Operations</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Search for parameter across inventory</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>maestro.sh<span class="w"> </span>search<span class="w"> </span>pattern
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1"># Search for class references</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>maestro.sh<span class="w"> </span>search-class<span class="w"> </span>classpattern
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1"># Search in playbooks</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>maestro.sh<span class="w"> </span>search-in-playbooks<span class="w"> </span>pattern
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="c1"># Search external variables</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>maestro.sh<span class="w"> </span>search-external<span class="w"> </span>pattern
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="c1"># Search reclass variables</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>maestro.sh<span class="w"> </span>search-reclass<span class="w"> </span>pattern
</code></pre></div>
<h4 id="status-and-information">Status and Information</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># Test host connectivity and show system info</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>maestro.sh<span class="w"> </span>status
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>maestro.sh<span class="w"> </span>ss
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1"># Show help</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>maestro.sh<span class="w"> </span><span class="nb">help</span>
</code></pre></div>
<h3 id="command-line-options">Command-Line Options</h3>
<h4 id="filtering-options">Filtering Options</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Filter by class</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>-C,<span class="w"> </span>--class<span class="w"> </span>CLASS
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># Filter by host/node</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>-H,<span class="w"> </span>--host<span class="w"> </span>HOST
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>-N,<span class="w"> </span>--node<span class="w"> </span>NODE
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c1"># Filter by project</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>-P,<span class="w"> </span>--project<span class="w"> </span>PROJECT
</code></pre></div>
<h4 id="execution-options">Execution Options</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Dry run mode</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>-n,<span class="w"> </span>--dry-run
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c1"># Force execution without prompts</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>-f,<span class="w"> </span>--force
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c1"># Interactive mode (ask before changes)</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>-i,<span class="w"> </span>--interactive
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c1"># Parser test mode</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>-p,<span class="w"> </span>--parser-test
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="c1"># Verbose output</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>-v,<span class="w"> </span>--verbose<span class="w"> </span><span class="o">[</span>level<span class="o">]</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c1"># Quiet mode</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>-q,<span class="w"> </span>--quiet
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="c1"># Custom work directory</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>-w,<span class="w"> </span>--workdir<span class="w"> </span>DIRECTORY
</code></pre></div>
<h4 id="configuration-options">Configuration Options</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Alternative config file</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>-c,<span class="w"> </span>--config<span class="w"> </span>CONFFILE
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c1"># Show version</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>-V,<span class="w"> </span>--version
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c1"># Show help</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>-h,<span class="w"> </span>--help
</code></pre></div>
<h2 id="configuration-schema">Configuration Schema</h2>
<h3 id="core-configuration-variables">Core Configuration Variables</h3>
<h4 id="project-settings">Project Settings</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Maestro&#39;s project directory</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nv">maestrodir</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PWD</span><span class="s2">&quot;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c1"># Repository directory name</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="nv">maestro_repo_dir_name</span><span class="o">=</span><span class="s2">&quot;maestro&quot;</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="nv">maestro_repo_dir</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$maestrodir</span><span class="s2">/</span><span class="nv">$maestro_repo_dir_name</span><span class="s2">&quot;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c1"># Working directory</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="nv">workdir</span><span class="o">=</span><span class="s2">&quot;./workdir&quot;</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="c1"># Execution modes</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="nv">force</span><span class="o">=</span><span class="m">1</span><span class="w">          </span><span class="c1"># 0=force, 1=interactive</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="nv">dryrun</span><span class="o">=</span><span class="m">1</span><span class="w">         </span><span class="c1"># 0=dry-run, 1=execute</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="nv">needsroot</span><span class="o">=</span><span class="m">1</span><span class="w">      </span><span class="c1"># Whether root privileges needed</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="nv">verbose</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w">      </span><span class="c1"># Verbosity level</span>
</code></pre></div>
<h4 id="repository-configuration">Repository Configuration</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Repositories to clone</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>toclone
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nv">toclone</span><span class="o">=(</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="o">[</span><span class="s2">&quot;maestro&quot;</span><span class="o">]=</span><span class="s2">&quot;https://github.com/inofix/maestro&quot;</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="o">[</span><span class="s2">&quot;common_inv&quot;</span><span class="o">]=</span><span class="s2">&quot;https://github.com/inofix/common-inv&quot;</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="o">[</span><span class="s2">&quot;common_playbooks&quot;</span><span class="o">]=</span><span class="s2">&quot;https://github.com/zwischenloesung/common-playbooks&quot;</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="o">)</span>
</code></pre></div>
<h4 id="directory-mappings">Directory Mappings</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Reclass inventory sources</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>inventorydirs
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="nv">inventorydirs</span><span class="o">=(</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="o">[</span><span class="s2">&quot;main&quot;</span><span class="o">]=</span><span class="s2">&quot;./inventory&quot;</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="o">)</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c1"># Ansible playbook directories</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>playbookdirs
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="nv">playbookdirs</span><span class="o">=(</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">    </span><span class="o">[</span><span class="s2">&quot;common_playbooks&quot;</span><span class="o">]=</span><span class="s2">&quot;./common_playbooks&quot;</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="o">)</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="c1"># Additional local directories</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="nb">declare</span><span class="w"> </span>-A<span class="w"> </span>localdirs
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="nv">localdirs</span><span class="o">=(</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">    </span><span class="o">[</span><span class="s2">&quot;packer_templates&quot;</span><span class="o">]=</span><span class="s2">&quot;./packer_templates&quot;</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">    </span><span class="o">[</span><span class="s2">&quot;vagrant_boxes&quot;</span><span class="o">]=</span><span class="s2">&quot;./vagrant_boxes&quot;</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="o">)</span>
</code></pre></div>
<h4 id="ansible-configuration">Ansible Configuration</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Ansible defaults</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nv">ansible_managed</span><span class="o">=</span><span class="s2">&quot;Ansible managed. All local changes will be lost!&quot;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="nv">ansible_timeout</span><span class="o">=</span><span class="s2">&quot;60&quot;</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="nv">ansible_scp_if_ssh</span><span class="o">=</span><span class="s2">&quot;True&quot;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="nv">ansible_galaxy_roles</span><span class="o">=</span><span class="s2">&quot;.ansible-galaxy-roles&quot;</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="nv">ansible_config_default</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$maestrodir</span><span class="s2">/ansible.cfg&quot;</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="c1"># Galaxy roles file</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="nv">galaxyroles</span><span class="o">=</span><span class="s2">&quot;galaxy/roles.yml&quot;</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="c1"># Connection script</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="nv">ansible_connect</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$maestro_repo_dir</span><span class="s2">/reclass-ansible.sh&quot;</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="c1"># Additional options</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="nv">ansibleoptions</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</code></pre></div>
<h2 id="migration-from-maestro-to-pyestro">Migration from Maestro to Pyestro</h2>
<h3 id="key-differences">Key Differences</h3>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Original Maestro</th>
<th>Pyestro</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Language</strong></td>
<td>Bash + AWK</td>
<td>Python 3.8+</td>
</tr>
<tr>
<td><strong>Configuration</strong></td>
<td><code>.maestro</code> file</td>
<td>JSON/YAML</td>
</tr>
<tr>
<td><strong>Parsing</strong></td>
<td>AWK scripts</td>
<td>Python libraries</td>
</tr>
<tr>
<td><strong>Error Handling</strong></td>
<td>Basic</td>
<td>Comprehensive</td>
</tr>
<tr>
<td><strong>Testing</strong></td>
<td>Manual</td>
<td>Unit tests</td>
</tr>
<tr>
<td><strong>Security</strong></td>
<td>Basic</td>
<td>Enhanced validation</td>
</tr>
<tr>
<td><strong>Performance</strong></td>
<td>Sequential</td>
<td>Potential parallelization</td>
</tr>
</tbody>
</table>
<h3 id="migration-path">Migration Path</h3>
<ol>
<li>
<p><strong>Configuration Conversion</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Original</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nv">maestrodir</span><span class="o">=</span><span class="s2">&quot;/path/to/project&quot;</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>toclone<span class="o">[</span><span class="s2">&quot;common_inv&quot;</span><span class="o">]=</span><span class="s2">&quot;https://github.com/example/inv.git&quot;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1"># Pyestro equivalent</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="o">{</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">  </span><span class="s2">&quot;maestro&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;project_dir&quot;</span>:<span class="w"> </span><span class="s2">&quot;/path/to/project&quot;</span><span class="o">}</span>,
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">  </span><span class="s2">&quot;repositories&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;common_inv&quot;</span>:<span class="w"> </span><span class="s2">&quot;https://github.com/example/inv.git&quot;</span><span class="o">}</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="o">}</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Command Mapping</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Original Maestro</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>maestro.sh<span class="w"> </span>nodes-list<span class="w"> </span>--class<span class="w"> </span>webserver
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>maestro.sh<span class="w"> </span>ansible-module<span class="w"> </span>ping
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>maestro.sh<span class="w"> </span>ansible-play<span class="w"> </span>site.yml
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="c1"># Pyestro equivalent</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>python<span class="w"> </span>pyestro.py<span class="w"> </span>nodes<span class="w"> </span>list<span class="w"> </span>--class<span class="w"> </span>webserver
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>python<span class="w"> </span>pyestro.py<span class="w"> </span>ansible<span class="w"> </span>module<span class="w"> </span>ping
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>python<span class="w"> </span>pyestro.py<span class="w"> </span>ansible<span class="w"> </span>playbook<span class="w"> </span>site.yml
</code></pre></div></p>
</li>
<li>
<p><strong>Feature Enhancement</strong></p>
</li>
<li>Enhanced search capabilities</li>
<li>Better error messages</li>
<li>Structured logging</li>
<li>Input validation</li>
<li>Dry-run improvements</li>
</ol>
<h3 id="compatibility-considerations">Compatibility Considerations</h3>
<div class="admonition warning">
<p class="admonition-title">Breaking Changes</p>
<ul>
<li>Configuration file format changed from bash to JSON/YAML</li>
<li>Command syntax slightly different</li>
<li>Some advanced AWK parsing may need adjustment</li>
<li>Error output format changed</li>
</ul>
</div>
<div class="admonition success">
<p class="admonition-title">Preserved Features</p>
<ul>
<li>Core workflow unchanged</li>
<li>Reclass integration compatible</li>
<li>Ansible integration compatible</li>
<li>Repository management logic preserved</li>
</ul>
</div>
<h2 id="technical-implementation-details">Technical Implementation Details</h2>
<h3 id="awk-parser-original">AWK Parser (Original)</h3>
<p>The original Maestro used complex AWK scripts for parsing reclass JSON output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Example AWK parser snippet</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nb">BEGIN</span> <span class="p">{</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    <span class="kr">split</span><span class="p">(</span><span class="nx">target_var</span><span class="p">,</span> <span class="nx">target_vars</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>    <span class="nx">spaces</span><span class="o">=</span><span class="s2">&quot;  &quot;</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    <span class="nx">i</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    <span class="nx">target</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="nx">spaces</span><span class="s2">&quot;&quot;</span><span class="nx">target_vars</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="s2">&quot;:&quot;</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>    <span class="nx">deeper</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="nx">spaces</span><span class="s2">&quot;[ -] &quot;</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="p">}</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="sr">/^parameters:$/</span> <span class="p">{</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>    <span class="nx">mode</span><span class="o">=</span><span class="s2">&quot;param&quot;</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>    <span class="kr">next</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="p">}</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="c1"># ... complex parsing logic</span>
</code></pre></div>
<h3 id="python-implementation-pyestro">Python Implementation (Pyestro)</h3>
<p>Pyestro replaces AWK with Python JSON parsing:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_node_data</span><span class="p">(</span><span class="n">node_name</span><span class="p">):</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>        <span class="s2">&quot;reclass&quot;</span><span class="p">,</span> <span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">inventory_dir</span><span class="p">,</span> 
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>        <span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="s2">&quot;--output&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>    <span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
</code></pre></div>
<h2 id="known-limitations-of-original-maestro">Known Limitations of Original Maestro</h2>
<h3 id="technical-limitations">Technical Limitations</h3>
<ul>
<li><strong>AWK Complexity</strong>: Complex parsing logic difficult to maintain</li>
<li><strong>Error Handling</strong>: Limited error recovery capabilities  </li>
<li><strong>Parallelization</strong>: No concurrent operations support</li>
<li><strong>Memory Usage</strong>: Large inventories may cause issues</li>
<li><strong>Platform Support</strong>: Unix/Linux only</li>
</ul>
<h3 id="functional-limitations">Functional Limitations</h3>
<ul>
<li><strong>Search Capabilities</strong>: Basic pattern matching only</li>
<li><strong>Validation</strong>: Limited input validation</li>
<li><strong>Logging</strong>: No structured logging</li>
<li><strong>Configuration</strong>: Limited configuration validation</li>
<li><strong>Security</strong>: Basic input sanitization</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>The original Maestro represents a practical solution to multi-environment configuration management challenges. While functional, its bash/AWK implementation presents maintenance and scalability challenges that the Python-based Pyestro project aims to address while preserving the core architectural concepts and workflows that make Maestro effective.</p>
<h3 id="key-takeaways">Key Takeaways</h3>
<ol>
<li><strong>Proven Architecture</strong>: The three-layer architecture works well in practice</li>
<li><strong>Reclass Integration</strong>: Using reclass as a knowledge base is effective</li>
<li><strong>Unified Interface</strong>: Single tool for multiple CM systems reduces complexity</li>
<li><strong>Evolution Need</strong>: Modern implementation needed for maintainability and features</li>
</ol>
<h3 id="next-steps">Next Steps</h3>
<ul>
<li>Review <a href="../../developer-guide/architecture/">Pyestro Specification</a> for the modern implementation</li>
<li>See <a href="../migration/">Migration Guide</a> for transitioning from Maestro to Pyestro</li>
<li>Check <a href="../cli/">Command Reference</a> for Pyestro command syntax</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/yourname/pyestro" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.highlight", "search.share", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>